# 如何获取 TrustFlowRide 合约地址

## 快速回答

**"Please enter TrustFlowRide contract address: 应该填什么？"**

答案：你需要先部署合约，然后使用部署脚本输出的合约地址。

## 获取合约地址的三种方法

### 方法一：部署合约（推荐用于开发/测试）

1. **启动本地 Hardhat 节点**（在项目根目录）：
   ```bash
   npm run node
   ```

2. **在另一个终端部署合约**：
   ```bash
   npm run deploy:local
   ```

3. **复制输出的地址**：
   部署完成后，终端会显示类似以下内容：
   ```
   ============================================================
   部署完成！
   ============================================================
   
   合约地址:
     TrustFlowEscrow:      0x5FbDB2315678afecb367f032d93F642f64180aa3
     TrustFlowRide:        0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512  ← 这个地址
     TrustFlowUserRegistry: 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0
     TrustFlowRating:      0xCf7Ed3AccA5a467e9e704C703E8D87F634fB0Fc9
     TrustFlowDispute:     0xDc64a140Aa3E981100a9becA4E685f962f0cF6C9
   ```

4. **在提示框中输入 TrustFlowRide 的地址**（例如：`0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512`）

### 方法二：从部署记录文件读取

部署完成后，合约地址会自动保存到 `deployments/` 目录：

1. **查看最新部署记录**：
   - 本地网络：`deployments/localhost-latest.json`
   - Mumbai测试网：`deployments/mumbai-latest.json`
   - Polygon主网：`deployments/polygon-latest.json`

2. **打开对应的 JSON 文件**，找到 `contracts.rideOrder` 字段的值

### 方法三：从 localStorage 读取（如果之前已设置）

如果你之前在浏览器中设置过地址，它会保存在浏览器的 localStorage 中。重新打开页面时会自动加载。

**手动设置（浏览器控制台）**：
```javascript
localStorage.setItem('RIDE_ORDER_ADDRESS', '你的合约地址');
localStorage.setItem('PAYMENT_ESCROW_ADDRESS', '托管合约地址');
localStorage.setItem('RATING_SYSTEM_ADDRESS', '评分合约地址');
```

然后刷新页面即可。

## 验证地址格式

正确的以太坊地址格式：
- ✅ 必须以 `0x` 开头
- ✅ 总长度为 42 个字符
- ✅ 后面40个字符是十六进制（0-9, a-f, A-F）

**示例**：
- ✅ `0x1234567890123456789012345678901234567890`
- ✅ `0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512`
- ❌ `0x123` （太短）
- ❌ `1234567890123456789012345678901234567890` （缺少 0x 前缀）

## 常见问题

### Q: 我还没有部署合约怎么办？

A: 你需要先部署合约才能使用应用。按照上面的"方法一"进行操作。

### Q: 部署合约需要多长时间？

A: 
- 本地网络：几秒钟
- 测试网（Mumbai）：2-5分钟（取决于网络状况）
- 主网：5-10分钟

### Q: 部署合约需要花费多少钱？

A:
- 本地网络：免费（测试币）
- Mumbai测试网：免费（测试网MATIC，可以从水龙头获取）
- Polygon主网：需要真实的MATIC代币（约0.1-0.5 MATIC）

### Q: 我可以使用测试网地址吗？

A: 可以！如果你的前端连接到Mumbai测试网，可以使用Mumbai测试网的合约地址。

### Q: 如何查看我已经部署的合约地址？

A: 检查以下位置：
1. 部署时的终端输出
2. `deployments/` 目录下的 JSON 文件
3. 浏览器 localStorage（如果之前设置过）
4. `.env` 文件中的 `RIDE_ORDER_ADDRESS` 配置

## 下一步

设置好合约地址后，你就可以：
1. ✅ 连接钱包
2. ✅ 创建订单
3. ✅ 与智能合约交互

如果遇到问题，请检查：
- 合约是否已正确部署
- 前端连接的网络是否与合约部署的网络一致
- 钱包是否连接到正确的网络

